(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11602,        324]
NotebookOptionsPosition[     10128,        284]
NotebookOutlinePosition[     10466,        299]
CellTagsIndexPosition[     10423,        296]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]cosmological", " ", "=", " ", ".001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["R", "c"], "=", " ", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7171876825779943`*^9, 3.717187711765641*^9}, {
   3.7171887113337107`*^9, 3.7171887276375513`*^9}, {3.717188814566161*^9, 
   3.717188815797413*^9}, 3.717188915214376*^9, {3.7177156389927387`*^9, 
   3.717715645240191*^9}},ExpressionUUID->"68ffee1c-526b-413e-b964-\
28185f27d486"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"startI", " ", "=", " ", "0.00000001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endI", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startE", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endE", " ", "=", " ", "1000"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7171878379915867`*^9, 3.717187865341462*^9}, {
  3.7171888641902933`*^9, 3.717188864349264*^9}, {3.7171888957580757`*^9, 
  3.717188899413085*^9}, {3.717188997774207*^9, 3.717189000845168*^9}, {
  3.717715492570788*^9, 3.717715503042573*^9}, {3.7177155974673643`*^9, 
  3.7177155981966677`*^9}, {3.7177156496656227`*^9, 
  3.717715658729785*^9}},ExpressionUUID->"dee5fa73-00fe-4e59-8958-\
2f1074548068"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7177148837267227`*^9, 
  3.717714888447651*^9}},ExpressionUUID->"f0738ac3-e96c-4a05-8789-\
5d564ece43f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"backgroundsolutioninterior", "[", "\[Phi]0_", "]"}], " ", ":=", 
  " ", 
  RowBox[{"NDSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SuperscriptBox[
           SubscriptBox["R", "c"], "2"]], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "r", "]"}], ",", "r", ",", "r"}], "]"}]}], 
        "+", 
        RowBox[{
         FractionBox["2", 
          RowBox[{"r", " ", 
           SubscriptBox["R", "c"]}]], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "r", "]"}], ",", "r"}], "]"}]}], "+", 
        RowBox[{
         FractionBox["2", 
          SuperscriptBox["\[CapitalLambda]", "2"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["4", 
             RowBox[{"r", " ", 
              SubscriptBox["R", "c"]}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "r", "]"}], ",", "r"}], "]"}]}], "+", 
           " ", 
           RowBox[{
            FractionBox["2", 
             RowBox[{
              SuperscriptBox["r", "2"], 
              SuperscriptBox[
               SubscriptBox["R", "c"], "2"]}]], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"\[Phi]", "[", "r", "]"}], ",", "r"}], "]"}], ")"}], 
             "2"]}]}], ")"}]}]}], "\[Equal]", 
       RowBox[{"8", "\[Pi]", " ", "\[Rho]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "startI", "]"}], " ", "\[Equal]", " ", 
       "0"}], ",", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "startI", "]"}], " ", "\[Equal]", "  ", 
       "\[Phi]0"}]}], "}"}], ",", "\[IndentingNewLine]", "\[Phi]", ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "startI", ",", "endI"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.717187454201481*^9, {3.7171875574006653`*^9, 3.717187561135795*^9}, {
   3.717187627136405*^9, 3.717187652390895*^9}, {3.717187724687566*^9, 
   3.717187727670658*^9}, {3.71718778154466*^9, 3.7171877840466547`*^9}, {
   3.717187829144314*^9, 3.717187853546371*^9}, {3.717188734286501*^9, 
   3.71718877361376*^9}, 3.717188843070814*^9, {3.7171889252468567`*^9, 
   3.717188928758301*^9}, {3.717189005126815*^9, 3.717189011902617*^9}, {
   3.717199510293131*^9, 3.7171995106365337`*^9}, {3.717714536926853*^9, 
   3.71771459175609*^9}},ExpressionUUID->"e8a316a6-5133-4155-98c3-\
07e436c27f46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"backgroundsolutionexterior", "[", "\[Phi]boundary_", "]"}], " ", ":=",
   " ", 
  RowBox[{"NDSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SuperscriptBox[
           SubscriptBox["R", "c"], "2"]], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Phi]e", "[", "r", "]"}], ",", "r", ",", "r"}], "]"}]}], 
        "+", 
        RowBox[{
         FractionBox["2", 
          RowBox[{"r", " ", 
           SubscriptBox["R", "c"]}]], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Phi]e", "[", "r", "]"}], ",", "r"}], "]"}]}], "+", 
        RowBox[{
         FractionBox["2", 
          SuperscriptBox["\[CapitalLambda]", "2"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["4", 
             RowBox[{"r", " ", 
              SubscriptBox["R", "c"]}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Phi]e", "[", "r", "]"}], ",", "r"}], "]"}]}], "+", 
           " ", 
           RowBox[{
            FractionBox["2", 
             RowBox[{
              SuperscriptBox["r", "2"], 
              SuperscriptBox[
               SubscriptBox["R", "c"], "2"]}]], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"\[Phi]e", "[", "r", "]"}], ",", "r"}], "]"}], ")"}], 
             "2"]}]}], ")"}]}]}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]e", "[", "startE", "]"}], " ", "\[Equal]", "  ", 
        RowBox[{"\[Phi]", "[", "1", "]"}]}], "/.", 
       RowBox[{"backgroundsolutioninterior", "[", "\[Phi]boundary", "]"}]}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]e", "'"}], "[", "startE", "]"}], " ", "\[Equal]", 
        "  ", 
        RowBox[{
         RowBox[{"\[Phi]", "'"}], "[", "1", "]"}]}], "/.", 
       RowBox[{"backgroundsolutioninterior", "[", "\[Phi]boundary", "]"}]}]}],
      "}"}], ",", "\[IndentingNewLine]", "\[Phi]e", ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "startE", ",", "endE"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.717188950102571*^9, 3.717188994781948*^9}, {
  3.71718907134284*^9, 3.717189074230885*^9}, {3.717189141799852*^9, 
  3.7171891937584143`*^9}, {3.7171892249837*^9, 3.717189236478507*^9}, {
  3.7171959125894337`*^9, 3.717195919005075*^9}, {3.717199506365204*^9, 
  3.717199506740453*^9}, {3.717714989106345*^9, 3.717715063905765*^9}, {
  3.71771509834863*^9, 3.717715102324726*^9}, {3.717715341260233*^9, 
  3.7177154540388317`*^9}},ExpressionUUID->"dd038c57-c54b-42b7-952f-\
70aa72d907c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Proximity", "[", "\[Phi]0_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Phi]e", "[", "endE", "]"}], "/.", 
      RowBox[{"backgroundsolutionexterior", "[", "\[Phi]0", "]"}]}], ")"}], 
    " ", "-", "\[Phi]cosmological"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7177163198596277`*^9, 3.717716399295906*^9}, {
   3.717716442548787*^9, 3.717716461798362*^9}, {3.7177165129476013`*^9, 
   3.71771651386749*^9}, {3.7177166221821127`*^9, 3.717716672066203*^9}, {
   3.717716729312357*^9, 3.7177167416087008`*^9}, 
   3.7177167853247643`*^9},ExpressionUUID->"5962dba8-f6c4-4376-a6f2-\
320a4ef50e69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Trialend", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Trialstart", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Trialstep", " ", "=", " ", ".00001"}], ";"}]}], "Input",
 CellChangeTimes->{{3.717716938501432*^9, 
  3.717716973198756*^9}},ExpressionUUID->"71a02173-8f59-4e7c-b05a-\
b8fedbf9e68e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solutions", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Proximity", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "Trialstart", ",", "Trialend", ",", "Trialstep"}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.717716789969371*^9, 3.717716831161577*^9}, {
  3.717716874573772*^9, 3.717716896615869*^9}, {3.71771697832082*^9, 
  3.71771699102514*^9}},ExpressionUUID->"54f7fcc2-c99b-4f9b-b9c9-\
2472d266788e"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.717716887699108*^9, 3.717716902103527*^9}, 
   3.7177170990004377`*^9},ExpressionUUID->"81fdbfea-490f-42cf-925f-\
72626e19b52c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", "solutions", "]"}]], "Input",
 CellChangeTimes->{{3.71771690693997*^9, 
  3.717716923538042*^9}},ExpressionUUID->"d0c04160-7bdf-4879-981c-\
c46a42eacec9"],

Cell[BoxData[
 TemplateBox[{
  "Plot","pllim",
   "\"Range specification \\!\\(\\*RowBox[{\\\"x\\\"}]\\) is not of the form \
{x, xmin, xmax}.\"",2,133,103,31841227593110941400,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7177169131229153`*^9, 
  3.717716919332896*^9}},ExpressionUUID->"487ed95f-436d-4792-af0a-\
53b29f70fc6b"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"solutions", "[", "x", "]"}], ",", "x"}], "]"}]], "Output",
 CellChangeTimes->{{3.717716913123803*^9, 
  3.717716919339642*^9}},ExpressionUUID->"9bef122e-08e1-433f-9280-\
bd66ea21ee01"]
}, Open  ]]
},
WindowSize->{1280, 963},
WindowMargins->{{Automatic, -324}, {Automatic, 29}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 681, 16, 103, "Input", "ExpressionUUID" -> \
"68ffee1c-526b-413e-b964-28185f27d486"],
Cell[1242, 38, 770, 16, 103, "Input", "ExpressionUUID" -> \
"dee5fa73-00fe-4e59-8958-2f1074548068"],
Cell[2015, 56, 154, 3, 32, "Input", "ExpressionUUID" -> \
"f0738ac3-e96c-4a05-8789-5d564ece43f7"],
Cell[2172, 61, 2584, 69, 143, "Input", "ExpressionUUID" -> \
"e8a316a6-5133-4155-98c3-07e436c27f46"],
Cell[4759, 132, 2757, 74, 167, "Input", "ExpressionUUID" -> \
"dd038c57-c54b-42b7-952f-70aa72d907c0"],
Cell[7519, 208, 678, 15, 34, "Input", "ExpressionUUID" -> \
"5962dba8-f6c4-4376-a6f2-320a4ef50e69"],
Cell[8200, 225, 385, 9, 80, "Input", "ExpressionUUID" -> \
"71a02173-8f59-4e7c-b05a-b8fedbf9e68e"],
Cell[CellGroupData[{
Cell[8610, 238, 481, 11, 34, "Input", "ExpressionUUID" -> \
"54f7fcc2-c99b-4f9b-b9c9-2472d266788e"],
Cell[9094, 251, 186, 3, 65, "Output", "ExpressionUUID" -> \
"81fdbfea-490f-42cf-925f-72626e19b52c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9317, 259, 190, 4, 32, "Input", "ExpressionUUID" -> \
"d0c04160-7bdf-4879-981c-c46a42eacec9"],
Cell[9510, 265, 355, 8, 23, "Message", "ExpressionUUID" -> \
"487ed95f-436d-4792-af0a-53b29f70fc6b"],
Cell[9868, 275, 244, 6, 34, "Output", "ExpressionUUID" -> \
"9bef122e-08e1-433f-9280-bd66ea21ee01"]
}, Open  ]]
}
]
*)

