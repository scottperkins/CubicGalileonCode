(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14065,        357]
NotebookOptionsPosition[     13130,        329]
NotebookOutlinePosition[     13464,        344]
CellTagsIndexPosition[     13421,        341]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["R", "c"], "=", " ", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.7171876825779943`*^9, 3.717187711765641*^9}, {
   3.7171887113337107`*^9, 3.7171887276375513`*^9}, {3.717188814566161*^9, 
   3.717188815797413*^9}, 3.717188915214376*^9, {3.7177156389927387`*^9, 
   3.717715645240191*^9}, 3.717719380645501*^9, {3.717720738231811*^9, 
   3.717720739934515*^9}},ExpressionUUID->"0a31e1d8-2181-4fc6-a55e-\
e845f606c291"],

Cell[BoxData[
 RowBox[{
  RowBox[{"backgroundsolution", "[", "\[Phi]0_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"startI", " ", "=", " ", "0.000001"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"endI", " ", "=", " ", "1.001"}], ",", "\[IndentingNewLine]", 
      RowBox[{"startE", " ", "=", " ", ".99"}], ",", "\[IndentingNewLine]", 
      RowBox[{"endE", " ", "=", " ", "1000"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", " ", "=", " ", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]cosmological", " ", "=", " ", ".001"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", " ", "=", " ", "10"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"backgroundsolutioninterior", "=", " ", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox["1", 
              SubscriptBox["R", "c"]], 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"\[Phi]", "[", "r", "]"}], ",", "r", ",", "r"}], 
              "]"}]}], "+", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"r", " ", 
               SubscriptBox["R", "c"]}]], 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"\[Phi]", "[", "r", "]"}], ",", "r"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["2", 
              SuperscriptBox["\[CapitalLambda]", "2"]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox["4", 
                 RowBox[{"r", " ", 
                  SubscriptBox["R", "c"]}]], 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "r", "]"}], ",", "r"}], "]"}]}], "+",
                " ", 
               RowBox[{
                FractionBox["2", 
                 RowBox[{
                  SuperscriptBox["r", "2"], 
                  SuperscriptBox[
                   SubscriptBox["R", "c"], "2"]}]], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "r", "]"}], ",", "r"}], "]"}], 
                  ")"}], "2"]}]}], ")"}]}]}], "\[Equal]", 
           RowBox[{"8", "\[Pi]", " ", "\[Rho]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]", "'"}], "[", "startI", "]"}], " ", "\[Equal]", 
           "0"}], ",", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "startI", "]"}], " ", "\[Equal]", "  ", 
           "\[Phi]0"}]}], "}"}], ",", "\[IndentingNewLine]", "\[Phi]", ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "startI", ",", "endI"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"backgroundsolutionexterior", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               SubscriptBox["R", "c"], "2"]], 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"\[Phi]e", "[", "r", "]"}], ",", "r", ",", "r"}], 
              "]"}]}], "+", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"r", " ", 
               SubscriptBox["R", "c"]}]], 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"\[Phi]e", "[", "r", "]"}], ",", "r"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["2", 
              SuperscriptBox["\[CapitalLambda]", "2"]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox["4", 
                 RowBox[{"r", " ", 
                  SubscriptBox["R", "c"]}]], 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]e", "[", "r", "]"}], ",", "r"}], "]"}]}], 
               "+", " ", 
               RowBox[{
                FractionBox["2", 
                 RowBox[{
                  SuperscriptBox["r", "2"], 
                  SuperscriptBox[
                   SubscriptBox["R", "c"], "2"]}]], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]e", "[", "r", "]"}], ",", "r"}], "]"}], 
                  ")"}], "2"]}]}], ")"}]}]}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]e", "[", "startE", "]"}], " ", "\[Equal]", "  ", 
            RowBox[{"\[Phi]", "[", "1", "]"}]}], "/.", 
           "backgroundsolutioninterior"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Phi]e", "'"}], "[", "startE", "]"}], " ", "\[Equal]", 
            " ", 
            RowBox[{
             RowBox[{"\[Phi]", "'"}], "[", "1", "]"}]}], "/.", 
           "backgroundsolutioninterior"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "\[Phi]e", ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "startE", ",", "endE"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Proximity", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Phi]e", "[", "endE", "]"}], "/.", 
         "backgroundsolutionexterior"}], ")"}], " ", "-", 
       "\[Phi]cosmological"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Prepend", "[", 
      RowBox[{"Proximity", ",", "\[Phi]0"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.717720180832419*^9, 3.717720290932157*^9}, {
   3.7177203336485157`*^9, 3.717720430923788*^9}, {3.717720526037847*^9, 
   3.717720576721911*^9}, 3.717720622150487*^9, {3.717720682445526*^9, 
   3.717720704845829*^9}, {3.717720808393235*^9, 3.717720816112739*^9}, {
   3.717720898825438*^9, 3.717720940500474*^9}, {3.717720982658033*^9, 
   3.71772099577792*^9}, {3.717721061217267*^9, 3.717721074465455*^9}, {
   3.717721125751382*^9, 3.7177212071431103`*^9}, {3.71772125486696*^9, 
   3.717721350388364*^9}},ExpressionUUID->"7f03efba-de65-4bb9-90a1-\
a98533c86e1e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Trialend", " ", "=", " ", ".1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Trialstart", " ", "=", " ", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Trialstep", " ", "=", " ", ".001"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solutions", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Proximity", "[", "i", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "i", ",", " ", "Trialstart", ",", " ", "Trialend", ",", " ", 
         "Trialstep"}], "}"}]}], "]"}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.717717928228112*^9, 3.7177179353466797`*^9}, {
   3.717718817168378*^9, 3.717718819727766*^9}, {3.717718866212996*^9, 
   3.717718867795904*^9}, 3.717720862451529*^9, 3.717721292637086*^9, {
   3.7177213641401987`*^9, 
   3.71772136817992*^9}},ExpressionUUID->"f84d3985-24a6-44f9-b6e3-\
fa922914b513"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solutions", " ", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{"backgroundsolution", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"Trialstart", ",", "Trialend", ",", "Trialstep"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7177180402048607`*^9, 3.717718067008099*^9}, 
   3.717718461654085*^9, 3.717718848363168*^9, {3.717718883048164*^9, 
   3.717718893166251*^9}, 3.71771991152861*^9, {3.717720777548153*^9, 
   3.717720782450938*^9}, 3.717720872943866*^9, 3.7177209189451637`*^9, 
   3.7177213732528563`*^9},ExpressionUUID->"5b5d92e9-1ad7-4453-ab41-\
cdeea652448c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Solutions", " ", "=", " ", 
    RowBox[{"Parallelize", "[", 
     RowBox[{"Map", "[", 
      RowBox[{"backgroundsolution", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"Trialstart", ",", "Trialend", ",", "Trialstep"}], "]"}]}], 
      "]"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.71772004524032*^9, 3.7177200617041197`*^9}, {
  3.717720838547985*^9, 3.717720841889801*^9}, {3.7177208805024347`*^9, 
  3.717720886421002*^9}},ExpressionUUID->"4338d738-60d2-4f07-8cda-\
5a68b16fec69"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "Solutions", "]"}]], "Input",
 CellChangeTimes->{{3.717717724310729*^9, 3.717717726326645*^9}, {
  3.717718141623703*^9, 
  3.717718149191215*^9}},ExpressionUUID->"cc28477d-24b4-4e9f-b679-\
45f56cf1e00e"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw1kwtYTGkcxkdlW+n7ZAdJLku6IBVhCf3/WlqbEmndrz3yhEhyieRSSZKE
kbQjmUpNqqmZqWmkXELaNpskEkrrUinLbG6b2DPT+b7nOc95znPOeb//+76/
b7hPgJevnkAg8OUu7Z0tl6zHlsP3EPwifVft4TMPKo1OB4zdy55Xw/DP89RT
9hP8b++Gy9tO+kH+ot76rmHs/RbwKrjp7hVBMKRfzi/Pdm+D2n7741dGsu+D
YWeQU+OGKIK7WqzGfZ+1BwyqO0btjGb/74czDrKg8BiC0xo8j57eHAb2x9YX
H4tlehFQ0m5hKI4jeOlXY70xhyLB0/3pvIwTTD8K2jMTEpUigk7K2ztKzkVD
aK8Fz6/Gs/1iwNiP2FUmECwcevD1/MJYEN0q21mXyPaPA0fLsGsvxATFN37M
3ep3HErCp/XWJLF5ToBX0wfvr8kE6z/rNoRmzEsySmHziWDfuY3NA9IImts/
GfndgVPQ76vleIt0Nm88iJc3hthLCS5dO1WrCJZFiTenXmTzJ0CF2W99ZmcT
TDyjWzAnuM8SbxnzkwhNteWS1XkE6+58XPB32u8QMjGizV/B/InBUOQ8aVc+
QTODhXSs/CyINZ/2HVQxv0kwdr6i/Lia4OIpOkG4JtskTCpi/pPBg9qsyCwm
6P7T4RmrXyRDg3/ThYIrLI/zsLVC/Pb6NYJt87WK58Fg9CKnv0pZPhIQRfWN
qL9J8Ij/q07pOwlYv6qofFXG8kqB0lmRph3lBMccGsBZSAHPVFwj+JPllwr1
ep2ZxncIVpyfVfBvVypsXZPfMbCK5ZkG+lcDnC2rCW7k0hpocAFih46OGlfD
8r0AVqHP706vJWj0IGXLdKN0UNYnmbs9ZHmng4fTEt+Fjwhmau2aZMDDBKHM
5zHLPwN8P1Z+2vyUoJtWboAUBAujXEIaWR9SCFO6xBxqItiqjXtwJvwg7Lp/
8jnrJxPSA1XDkl8S1KZXNeIiTKkKXJ/VzPq6CJftbBWFrQRHLT92/b1NFqw8
+vLLjTbWXxa0vE52vfuGYDmnNsg+G0LclsU9ecv6zAYTaf9HLRqC64+374GJ
OSAxrLL40MH6zQHbddGb9D4S5IbjLMtAdmOmin5mfctgjsU3gXknQW8OHq5S
aDigdrPuYv3nwqbGIJHjN4KpXHoPUnKhy9nuKfSgPA+5EHO22dpdn2JHV01w
i1UeDPoiCVzck/J85IF86YqitYYUZ+oAyANQm/YM7EV5XvLggWn13NDeFEUD
dYbAe0dMwmFCeX7k8KHGtelUH4rd48lhu2MPW0lfyvMkB+GJou05QoqOuqWA
U2+3X7nUn/J8KcDW06FXmSnF8Kt/cAQpQJXd6nXPjPK8KWCWcZq4wZziPa59
LhOo3rDq5eshlOdPCT7lZg6fhlG00AkqQWNds8tgBOV5VEJ4ZGypyUiKQX7a
AvJB+GI2GWJFeT7zIeVn/UWjbCiWvrfhGs4HO0lx8sTRlOe1AEoEwa0zbCkK
uweEuavGT5hrR3l+C6CuuC10qQNF3XS3C8B/cHrZuvGU51kFmt1r+gZNoCg/
+0/6rTkqCK0zX7ZvEuX5VoH55NrUI5Mp6ukMq+BcfNyb006U570QrN+7TU6d
RtGrGxi4vqBnWK4z5fkvBA/5lYrLSFGitVtTCM9Mdvcvd6H8eVCDf8CEVfdn
UtRo5RarobPyTcYzV8qfDzVE20o17bMp/g9y4NkQ
      
      "]]}, {}}, {}, {}, {{}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 3.6806100995992264`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.1}, {3.685610099598791, 3.785610099590092}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.717717730813653*^9, {3.7177181378798523`*^9, 3.717718149786669*^9}, 
   3.717718627098486*^9, {3.717718745026909*^9, 3.717718765798059*^9}, 
   3.717719625116929*^9, 3.717719808073022*^9, 3.717719846853099*^9, {
   3.717719878727635*^9, 3.717719903092461*^9}, 3.7177199522897463`*^9, 
   3.717720847398662*^9, {3.717720893988502*^9, 3.717720912917405*^9}, 
   3.7177210816640453`*^9, {3.717721357244467*^9, 
   3.717721375751418*^9}},ExpressionUUID->"db69f025-eb4b-42b9-8e1c-\
bb656fc160bf"]
}, Open  ]]
},
WindowSize->{956, 1019},
WindowMargins->{{Automatic, 4}, {0, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 470, 9, 34, "Input", "ExpressionUUID" -> \
"0a31e1d8-2181-4fc6-a55e-e845f606c291"],
Cell[1031, 31, 6251, 157, 544, "Input", "ExpressionUUID" -> \
"7f03efba-de65-4bb9-90a1-a98533c86e1e"],
Cell[7285, 190, 906, 23, 103, "Input", "ExpressionUUID" -> \
"f84d3985-24a6-44f9-b6e3-fa922914b513"],
Cell[8194, 215, 627, 13, 34, "Input", "ExpressionUUID" -> \
"5b5d92e9-1ad7-4453-ab41-cdeea652448c"],
Cell[8824, 230, 559, 13, 34, "Input", "ExpressionUUID" -> \
"4338d738-60d2-4f07-8cda-5a68b16fec69"],
Cell[CellGroupData[{
Cell[9408, 247, 244, 5, 32, "Input", "ExpressionUUID" -> \
"cc28477d-24b4-4e9f-b679-45f56cf1e00e"],
Cell[9655, 254, 3459, 72, 274, "Output", "ExpressionUUID" -> \
"db69f025-eb4b-42b9-8e1c-bb656fc160bf"]
}, Open  ]]
}
]
*)

